import { buildEntitySecret } from "../../utils.mjs";
export var DevbaseHeader;
(function (DevbaseHeader) {
    DevbaseHeader["SECRET"] = "X-Devbase-Secret";
    DevbaseHeader["USER_ID"] = "X-Devbase-UserId";
    DevbaseHeader["USER_TOKEN"] = "X-Devbase-UserToken";
})(DevbaseHeader || (DevbaseHeader = {}));
export class BaseProcessor {
    context;
    constructor(context) {
        this.context = context;
    }
    buildHeaders(entityName, entityId) {
        const { appId, user } = this.context;
        const headers = {};
        if (entityName) {
            headers[DevbaseHeader.SECRET] = buildEntitySecret({ appId, entityName, entityId });
        }
        if (user) {
            headers[DevbaseHeader.USER_ID] = user.id;
            headers[DevbaseHeader.USER_TOKEN] = user.token;
        }
        return headers;
    }
}
